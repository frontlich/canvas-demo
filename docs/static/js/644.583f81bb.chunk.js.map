{"version":3,"file":"static/js/644.583f81bb.chunk.js","mappings":"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","sources":["pages/fireworks/drawFirework.ts","utils/hex2rgb.ts","pages/fireworks/index.tsx"],"sourcesContent":["import { hex2rgb } from \"../../utils/hex2rgb\";\n\nconst colors = [\n  \"#ff0\",\n  \"#ff9912\",\n  \"#0ff\",\n  \"#0f0\",\n  \"#7cfc00\",\n  \"#f0f\",\n  \"#ff4500\",\n  \"#1e90ff\",\n  \"#fafff0\",\n];\n\nconst drawAmmo = (\n  ctx: CanvasRenderingContext2D,\n  point: Point,\n  color: string\n) => {\n  return new Promise<void>((resolve) => {\n    let distance = window.innerHeight - point[1];\n\n    const draw = () => {\n      if (distance <= 1) {\n        resolve();\n        return;\n      }\n      distance = distance * 0.9;\n\n      ctx.beginPath();\n      ctx.arc(point[0], point[1] + distance, 5, 0, 2 * Math.PI);\n      ctx.fillStyle = color;\n      ctx.fill();\n      ctx.closePath();\n\n      requestAnimationFrame(() => {\n        ctx.beginPath();\n        ctx.fillStyle = \"#000\";\n        ctx.arc(point[0], point[1] + distance, 6, 0, 2 * Math.PI);\n        ctx.fill();\n        ctx.closePath();\n        draw();\n      });\n    };\n\n    draw();\n  });\n};\n\nconst drawParticle = (\n  ctx: CanvasRenderingContext2D,\n  point: Point,\n  color: string,\n  angle: number,\n  speed: number\n) => {\n  const gra = 10, //重力加速度\n    existTime = 3, // 存在时间\n    particleSize = 2, //粒子大小\n    upSpeed = 10; // 初始的向上的速度\n\n  const speedX = speed * Math.cos(angle),\n    speedY = speed * Math.sin(angle) + upSpeed;\n\n  const draw = (t: number) => {\n    if (t > existTime) return;\n\n    const temp = [\n      point[0] + speedX * t,\n      point[1] + (gra * t * t) / 2 - speedY * t,\n    ];\n    ctx.beginPath();\n    ctx.arc(temp[0], temp[1], particleSize, 0, 2 * Math.PI);\n    const [r, g, b] = hex2rgb(color);\n    const a = existTime - t;\n    ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${a > 1 ? 1 : a})`;\n    ctx.fill();\n    ctx.closePath();\n\n    requestAnimationFrame(() => {\n      ctx.beginPath();\n      ctx.arc(temp[0], temp[1], particleSize + 1, 0, 2 * Math.PI);\n      ctx.fillStyle = \"#000\";\n      ctx.fill();\n      ctx.closePath();\n      draw(t + 0.02);\n    });\n  };\n\n  draw(0);\n};\n\nconst drawBoom = (\n  ctx: CanvasRenderingContext2D,\n  point: Point,\n  color: string\n) => {\n  let speed = 60;\n\n  for (let i = 5; i < speed; i += 10) {\n    for (let j = ((i % 2) / 20) * Math.PI; j < 2 * Math.PI; j += Math.PI / 10) {\n      drawParticle(ctx, point, color, j, i);\n    }\n  }\n};\n\nexport const drawFirework = (ctx: CanvasRenderingContext2D, point: Point) => {\n  const color = colors[Math.round(Math.random() * (colors.length - 1))];\n  drawAmmo(ctx, point, color).then(() => drawBoom(ctx, point, color));\n};\n","export const hex2rgb = (hex: string): [number, number, number] => {\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n    let c = hex.substring(1).split(\"\");\n    if (c.length === 3) {\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]];\n    }\n    const v = Number(\"0x\" + c.join(\"\"));\n    return [(v >> 16) & 255, (v >> 8) & 255, v & 255];\n  }\n  throw new Error(\"Bad Hex\");\n};\n","import { memo, useEffect, useRef } from \"react\";\nimport { drawFirework } from \"./drawFirework\";\n\nexport default memo(() => {\n  const ref = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    if (ref.current) {\n      const ctx = ref.current.getContext(\"2d\");\n\n      const draw = (e: MouseEvent) => {\n        ctx && drawFirework(ctx, [e.clientX, e.clientY]);\n      }\n     \n      document.addEventListener('click', draw);\n\n      return () => document.removeEventListener('click', draw);\n    }\n  }, []);\n\n  return (\n    <canvas\n      ref={ref}\n      width={window.innerWidth}\n      height={window.innerHeight}\n      style={{ background: \"#000\", cursor: 'crosshair' }}\n    />\n  );\n});\n"],"names":["colors","drawParticle","ctx","point","color","angle","speed","speedX","Math","cos","speedY","sin","draw","t","temp","beginPath","arc","PI","hex","test","c","substring","split","length","v","Number","join","Error","hex2rgb","r","g","b","a","fillStyle","fill","closePath","requestAnimationFrame","particleSize","drawFirework","round","random","Promise","resolve","distance","window","innerHeight","drawAmmo","then","i","j","drawBoom","memo","ref","useRef","useEffect","current","getContext","e","clientX","clientY","document","addEventListener","removeEventListener","width","innerWidth","height","style","background","cursor"],"sourceRoot":""}